/* how-it-works.css — vyčištěná a optimalizovaná verze (bez :root) */

/* KONTEJNER */
.hiw-section { display:flex; justify-content:center; padding:60px 16px; }

/* PAPER WRAP */
.hiw-paper-wrap{
  width: min(1200px,96%);
  position:relative;
  background-image:
    radial-gradient(800px 280px at 10% 10%, rgba(248,230,176,0.06), transparent 18%),
    radial-gradient(700px 220px at 85% 12%, rgba(207,155,60,0.04), transparent 16%),
    url('/assets/paper-texture.png');
  background-position: center;
  background-size: 100% 100%;
  background-repeat: no-repeat;
  border-radius: 10px;
  padding: 56px;
  box-shadow:
    0 40px 90px rgba(0,0,0,0.16),
    inset 0 18px 40px rgba(0,0,0,0.13),
    inset 0 0 140px rgba(0,0,0,0.06);
  overflow: visible;
  -webkit-font-smoothing:antialiased;
}

/* burnt edges + rim highlight */
.hiw-paper-wrap::before{
  content:"";
  position:absolute; inset:0;
  z-index:2; border-radius:10px; pointer-events:none;
  background:
    radial-gradient(120px 80px at 6% 6%, rgba(0,0,0,0.28), rgba(0,0,0,0) 40%),
    radial-gradient(120px 80px at 94% 94%, rgba(0,0,0,0.24), rgba(0,0,0,0) 40%),
    linear-gradient(to top, rgba(0,0,0,0.18), rgba(0,0,0,0) 14%) top/100% 26px no-repeat,
    linear-gradient(to bottom, rgba(0,0,0,0.18), rgba(0,0,0,0) 14%) bottom/100% 26px no-repeat,
    linear-gradient(to left, rgba(0,0,0,0.14), rgba(0,0,0,0) 14%) left/26px 100% no-repeat,
    linear-gradient(to right, rgba(0,0,0,0.14), rgba(0,0,0,0) 14%) right/26px 100% no-repeat;
  mix-blend-mode:multiply;
}
.hiw-paper-wrap::after{
  content:"";
  position:absolute; inset:0;
  z-index:3; pointer-events:none;
  background:
    radial-gradient(900px 300px at 85% 10%, rgba(255,230,170,0.18), transparent 16%),
    linear-gradient(180deg, rgba(255,255,255,0.02), transparent 10%);
  background-repeat:no-repeat;
  background-position:center, top;
  background-size:100% 60%, 100% 15%;
  mix-blend-mode:screen; filter: blur(4px) contrast(1.02);
}

/* grain & inner edge */
.hiw-grain-overlay{
  position:absolute; inset:0;
  z-index:4; pointer-events:none;
  background-image:
    radial-gradient(circle at 20% 10%, rgba(0,0,0,0.02) 0 1px, transparent 1px),
    radial-gradient(circle at 80% 90%, rgba(0,0,0,0.02) 0 1px, transparent 1px);
  background-size:3px 3px,4px 4px;
  opacity:0.06; mix-blend-mode:multiply; transform:translateZ(0);
}
.hiw-paper-edge{
  position:absolute; inset:10px;
  border-radius:8px; z-index:5; pointer-events:none;
  box-shadow: inset 0 6px 0 rgba(255,245,230,0.06), inset 0 -8px 18px rgba(0,0,0,0.08);
}

/* ===== HOW IT WORKS steps container — matched to TOPBOOKS style ===== */

.hiw-steps {
  display: grid;
  grid-template-columns: repeat(4, minmax(220px, 1fr)); /* desktop 4 sloupce */
  gap: 22px;
  padding: 0 1% 1% 1%;
  border-radius: 18px;
  position: relative;
  overflow: visible;
  isolation: isolate;
  z-index: 6;

  /* parchment base + subtle centered band (as a soft background layer) */
  background:
    linear-gradient(90deg, rgba(255,247,232,0.06), rgba(255,245,226,0.04)),
    linear-gradient(90deg, transparent 0%, rgba(20,12,6,0.02) 20%, rgba(185,135,50,0.06) 48%, transparent 100%);
  background-blend-mode: normal;
  /* odstraněn hrubý border-top — používáme dekorativní pás přes pseudo-element */
  box-shadow:
    0 8px 22px rgba(0,0,0,0.16),
    inset 0 1px 0 rgba(255,255,255,0.04);
}

/* decorative gold strip across the top (replaces border-top) */
.hiw-steps::before {
  content: "";
  position: absolute;
  top: -8px;
  left: 6%;
  right: 6%;
  height: 8px;
  border-radius: 6px 6px 0 0;
  background: linear-gradient(90deg, #e3bb5f 0%, #cf9b3a 38%, #ffe89c 62%, #cfa84d 100%);
  box-shadow: 0 4px 12px rgba(207,155,60,0.24);
  z-index: 3;
  pointer-events: none;
}

/* parchment grain overlay (low-opacity texture) */
.hiw-steps::after {
  content: "";
  position: absolute;
  inset: 0;
  z-index: 2;
  pointer-events: none;
  background-image:
    radial-gradient(circle at 20% 10%, rgba(0,0,0,0.02) 0 1px, transparent 1px),
    radial-gradient(circle at 80% 90%, rgba(0,0,0,0.02) 0 1px, transparent 1px);
  background-size: 3px 3px, 4px 4px;
  opacity: var(--hiw-grain-opacity, 0.04);
}

/* subtle horizontal divider (visual guide between rows) — gentle, hidden on narrower screens 
.hiw-steps ._internal-divider-faux {
  /* This rule is a pure visual fallback in case layout needs an inner divider via element;
     if you don't want to add an element, the center-band background above already provides the effect. 
}*/

/* responsive breakpoints: 2 columns and single column fallbacks */
@media (max-width: 1100px) {
  .hiw-steps { grid-template-columns: repeat(2, minmax(220px, 1fr)); padding: 28px; border-radius: 16px; }
  .hiw-steps::before { left: 8%; right: 8%; }
}

@media (max-width: 520px) {
  .hiw-steps { grid-template-columns: 1fr; padding: 20px; border-radius: 12px; gap: 14px; }
  .hiw-steps::before { left: 10%; right: 10%; height: 5px; top: -6px; }
  .hiw-steps::after { opacity: 0.04; background-size: 420px 420px; }
}

/* prefers-reduced-motion: keep things static */
@media (prefers-reduced-motion: reduce) {
  .hiw-steps { transition: none; }
  .hiw-steps::before,
  .hiw-steps::after { transition: none; }
}

/* ===== Per-card unified ===== */
.hiw-step {
  position: relative;
  z-index: 4;
  padding: 26px 18px;
  border-radius: 14px;
  overflow: visible;
  text-align: center;
  background:
    linear-gradient(90deg, rgba(212,160,23,0.12) 0%, rgba(212,160,23,0.06) 30%, transparent 70%),
    linear-gradient(180deg, rgba(255,255,255,0.025), rgba(0,0,0,0.03)),
    linear-gradient(180deg, #e7d29a 10%, #e7d29a 5%);
  box-shadow:
    0 28px 60px rgba(18,12,6,0.14),
    inset 0 -12px 28px rgba(230,200,120,0.03);
  transition: transform .28s cubic-bezier(.2,.9,.3,1), box-shadow .28s ease, border-left-color .28s ease;
}
.hiw-step::after {
  content: "";
  position: absolute;
  top: 12px; right: 12px;
  z-index: 8;
  width: 56px; height: 10px;
  border-radius: 6px;
  background: linear-gradient(90deg, rgba(255,240,200,0.8), rgba(255,185,85,0.9));
  box-shadow: 0 4px 10px rgba(207,155,60,0.25);
  transform: rotate(12deg);
  opacity: 0.9;
  pointer-events: none;
}
.hiw-step::before {
  content: "";
  position: absolute;
  left: 12px;
  top: 12px;
  bottom: 12px;
  width: 8px;
  border-radius: 6px;
  background: linear-gradient(180deg, #f8e6b0 0%, #d9b069 40%, #c9972e 100%);
  box-shadow: 0 6px 16px rgba(207,155,60,0.16), inset 0 1px 0 rgba(255,255,255,0.18);
  z-index: 2;
  pointer-events: none;
}
.hiw-step:hover {
  transform: translateY(-8px);
  border-left-color: #be7f18;
  box-shadow:
    0 44px 80px rgba(18,12,6,0.20),
    inset 0 -18px 40px rgba(230,190,100,0.05);
}
.hiw-step .divider {
  height: 1px;
  margin: 18px 12%;
  background: linear-gradient(90deg, rgba(20,12,6,0.02), rgba(20,12,6,0.04), rgba(20,12,6,0.02));
  pointer-events: none;
}

/* ===== Icon unified (oprava „čtverečků“) ===== */
.hiw-step-icon {
  width: 76px;
  height: 76px;
  margin: 0 auto 14px;
  border-radius: 40%;
  overflow: hidden;                /* ✅ klíčové pro ořez pseudo-elementů */
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  z-index: 6;
  background: radial-gradient(circle at 30% 30%, #fff4b0 0%, #e7cf98 60%);
  border: 3px solid #c89a12;
  box-shadow:
    0 14px 32px rgba(18,12,6,0.14),
    0 0 26px rgba(212,160,23,0.08),
    inset 0 6px 12px rgba(255,245,210,0.28);
  animation: icon-pulse-v3 6s ease-in-out infinite, icon-tilt-v3 10s ease-in-out infinite;
}
.hiw-step-icon svg {
  width: 60%;
  height: 60%;
  overflow: visible; /* zajistí, že SVG se nevystřihne */
}
.hiw-step-icon::after {
  content: "";
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  border-radius: inherit;          /* ✅ pseudo-element je taky kulatý */
  background: linear-gradient(120deg, transparent 0%, rgba(255,255,255,0.35) 50%, transparent 100%);
  background-size: 200px 100%;
  animation: icon-shine-v3 8s ease-in-out infinite;
  pointer-events: none;
}
.hiw-step-icon::before {
  content: "";
  position: absolute;
  left: -8px; top: -8px; right: -8px; bottom: -8px;
  border-radius: 50%;
  box-shadow: 0 0 40px rgba(212,160,23,0.10);
  pointer-events: none;
  z-index: -1;
}
/* volitelně zajistí kulatost i pro vnořenou grafiku */
.hiw-step-icon img,
.hiw-step-icon svg {
  display: block;
  max-width: 70%;
  max-height: 70%;
  border-radius: 50%;
}

.hiw-step:hover .hiw-step-icon {
  animation: icon-pulse-v3 4s ease-in-out infinite, icon-tilt-v3 8s ease-in-out infinite;
}

/* Animace */
@keyframes icon-shine-v3 {
  0% { background-position: -150px 0; }
  50% { background-position: 150px 0; }
  100% { background-position: 300px 0; }
}
@keyframes icon-pulse-v3 {
  0%, 100% { box-shadow: 0 0 10px rgba(255, 200, 100, 0.3); }
  50% { box-shadow: 0 0 20px rgba(255, 210, 130, 0.55); }
}
@keyframes icon-tilt-v3 {
  0%, 100% { transform: rotateY(0deg) rotateX(0deg); }
  50% { transform: rotateY(1.5deg) rotateX(-0.5deg); }
}

/* TEXT */
.hiw-step-text{
  margin-left:5%; color:rgba(59,42,26,0.92);
  line-height:1.4; font-weight:600;
  font-size:0.96rem;
}
.hiw-step code{
  background: rgba(0,0,0,0.04);
  padding:2px 6px; border-radius:6px;
  font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
  font-size:.95em;
}

/* responsiveness: 4 / 3 / 2 / 1 */
@media (max-width:1100px){
  .hiw-steps{ grid-template-columns: repeat(3, minmax(200px, 1fr)); padding: 28px; }
}
@media (max-width:820px){
  .hiw-steps{ grid-template-columns: repeat(2, minmax(200px, 1fr)); padding: 20px; gap:16px; }
}
@media (max-width:480px){
  .hiw-steps{ grid-template-columns: 1fr; padding: 16px; gap:12px; }
  .hiw-step-icon{ width:56px; height:56px; font-size:22px; }
  .hiw-title{ font-size:1.9rem; }
}

/* accessibility */
@media (prefers-reduced-motion:reduce){
  *{ transition:none !important; animation:none !important; }
  .hiw-cta::before, .hiw-steps::before { display:none !important; }
}